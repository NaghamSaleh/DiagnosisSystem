@model PatientDTO
<link rel="stylesheet" type="text/css" href="/css/Patient/MyAccount.css">

<div class="navbar">
    <div class="nav-option" id="myAccount">My Account</div>
    <div class="nav-option" id="myQueries">My Queries</div>
    <div class="nav-option" id="contactUs">Contact Us</div>
    <div class="selector"></div>
</div>

<div class="myaccountcontainer" id="myAccount-container">
    <h1 class="section-title">My Account Information</h1>
    <a asp-action="Edit" asp-controller="Patient" >Edit Account</a>
    

    <div class="info-item">
        <span class="info-label">Full Name:</span>
        <span class="info-value">@Model.EditProfileVM.FirstName @Model.EditProfileVM.LastName</span>
    </div>

    <div class="info-item">
        <span class="info-label">Email:</span>
        <span class="info-value">@Model.EditProfileVM.Email</span>
    </div>

    <div class="info-item">
        <span class="info-label">Gender:</span>
        <span class="info-value">@Model.EditProfileVM.Gender</span>
    </div>

    <div class="info-item">
        <span class="info-label">Telephone:</span>
        <span class="info-value">@Model.EditProfileVM.Telephone</span>
    </div>
</div>

<div class="myqueriescontainer" id="myQueries-container">
    <!-- My Queries Information -->
    <ul id="queries-list">
        @if (Model.QueryVM != null && Model.QueryVM.Any())
        {
            foreach(var query in Model.QueryVM)
        {
            <li>
                <div>
                    <span>@query.QueryTitle</span>
                </div>
                
                <div>
                    <span>Votes: @query.Votes</span>
                </div>
                <div>
                    <span>Number of Answers: @query.AnswerCount</span>
                </div>
                </li>
            }
        }
        else
        {
            <li id="no-queries-msg">You have no queries.</li>
        }

    </ul>
    <a asp-action="Create" asp-controller="Patient" class="btn btn-primary" >Click here to start a query</a>
</div>

<script>
    // Sample queries array
    var queries = []; // Replace this with your actual queries array
    
    // Function to render queries or show "no queries" message
    function renderQueries() {
        var queriesList = document.getElementById('queries-list');
        var noQueriesMsg = document.getElementById('no-queries-msg');
        var startQueryLink = document.getElementById('start-query-link');
        
        queriesList.innerHTML = ''; // Clear previous queries
        
        if (queries.length > 0) {
            queries.forEach(function(query) {
                var li = document.createElement('li');
                li.textContent = query;
                queriesList.appendChild(li);
            });
            noQueriesMsg.style.display = 'none';
            startQueryLink.style.display = 'none';
        } else {
            noQueriesMsg.style.display = 'block';
            startQueryLink.style.display = 'block';
        }
    }

    // Call renderQueries function when the page loads
    window.onload = function() {
        renderQueries();
    };
</script>


<div class="contactuscontainer" id="contactUs-container">
    <!-- Contact Us Information -->
</div>

<header class="header">
    <div class="brand">Qure</div>

    <nav class="choices">
        <a asp-action="Queries" asp-controller="Patient">User Queries</a>
        <a asp-action="" asp-controller="Patient">Paid consultancy</a>
        <a asp-action="" asp-controller="Patient">Analytics</a>
        <a asp-action="MyAccount" asp-controller="Patient" class="account-link">
            <div class="info-item">
                @if (Model.EditProfileVM.ImageData != null && Model.EditProfileVM.ImageData.Length > 0)
                {
                    var imageBase64 = Convert.ToBase64String(Model.EditProfileVM.ImageData);
                    var imageSrc = $"data:{Model.EditProfileVM.ImageType};base64,{imageBase64}";
                    <img src="@imageSrc" alt="Profile Picture" class="account-icon" />
                }
                else
                {
                    <img src="~/user.png" alt="My Account" class="account-icon">
                }
            </div>
        </a>
    </nav>
    
</header>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    $(document).ready(function () {
        $(".nav-option").click(function () {
            var sectionId = $(this).attr("id") + "-container";
            var scrollToElement = $("#" + sectionId);

            // Smooth scroll to the target element
            $('html, body').animate({
                scrollTop: scrollToElement.offset().top
            }, 1000);

            // Update selected state and selector position
            $(".nav-option").removeClass("selected");
            $(this).addClass("selected");

            var index = $(this).index();
            var widthSum = 0;

            // Calculate the total width of all options before the clicked one
            for (var i = 0; i < index; i++) {
                widthSum += $(".nav-option").eq(i).outerWidth(true);
            }

            // Calculate the left position for the selector
            var leftPosition = widthSum + ($(this).outerWidth(true) - $(".selector").outerWidth()) / 2;
            $(".selector").css("left", leftPosition + "px");
        });

        // Initial positioning of selector
        var initialPosition = $(".nav-option.selected").position().left;
        $(".selector").css("left", initialPosition + "px");
    });
</script>
